(function(t){function e(e){for(var s,r,i=e[0],c=e[1],u=e[2],m=0,f=[];m<i.length;m++)r=i[m],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&f.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);l&&l(e);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(s=!1)}s&&(o.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},a={main:0},o=[];function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/tasty-twitter/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("f5cc")},1239:function(t,e,n){},2102:function(t,e,n){"use strict";n("39cf");var s=n("b9c7");n.d(e,"CreatePostForm",(function(){return s["a"]}))},"39cf":function(t,e){},"468f":function(t,e,n){},"7ba4":function(t,e,n){},"987e":function(t,e,n){"use strict";n("1239")},a82a:function(t,e,n){"use strict";n("cdff")},af1d:function(t,e,n){"use strict";n("7ba4")},b9c7:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",{ref:"form",staticClass:"create-post-form",attrs:{disabled:t.submitInProgress},on:{submit:function(e){return e.preventDefault(),t.submitHandler(e)}}},[n("div",{staticClass:"create-post-form--input-area"},[n("v-text-field",{attrs:{rules:t.rules.content,placeholder:"Что происходит?",outlined:""},model:{value:t.model.content,callback:function(e){t.$set(t.model,"content",e)},expression:"model.content"}})],1),n("v-btn",{attrs:{color:"primary",type:"submit","x-large":"",loading:t.submitInProgress}},[t._v(" Поделиться ")])],1)},a=[],o=(n("d3b7"),n("2b0e")),r=o["a"].extend({name:"CreatePostForm",data:function(){return{submitInProgress:!1,model:{content:""},rules:{content:[function(t){return!!t||"Сообщение обязательно"}]}}},props:{onSubmit:{type:Function,required:!0}},methods:{submitHandler:function(){var t=this,e=this.$refs.form;e.validate()&&(this.submitInProgress=!0,this.onSubmit(this.model).then((function(){t.resetModel(),e.resetValidation()})).catch((function(t){throw t})).finally((function(){t.submitInProgress=!1})))},resetModel:function(){this.model.content=""}}}),i=r,c=(n("987e"),n("2877")),u=n("6544"),l=n.n(u),m=n("8336"),f=n("4bd4"),p=n("8654"),d=Object(c["a"])(i,s,a,!1,null,null,null);e["a"]=d.exports;l()(d,{VBtn:m["a"],VForm:f["a"],VTextField:p["a"]})},cdff:function(t,e,n){},e469:function(t,e,n){"use strict";n("468f")},f5cc:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("98db");var s=n("4bc7"),a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-main",[n("v-container",[n("div",[n("v-btn",{staticClass:"mx-2",attrs:{icon:"",raised:"",large:""},on:{click:t.toggleTheme}},[n("v-icon",{attrs:{dark:"",large:""}},[t._v(" "+t._s(t.mdiThemeLightDark)+" ")])],1)],1),n("router-view")],1)],1)],1)},r=[],i=n("5530"),c=n("94ed"),u="IApplicationConfigRepository",l=(n("d3b7"),n("d4ec")),m=n("bee2"),f=n("4b96"),p="TT_APPLICATION_CONFIG",d={darkTheme:!1},v=function(){function t(e){Object(l["a"])(this,t),this._storage=e,this._config=new f["a"](1),this._initConfig()}return Object(m["a"])(t,[{key:"changeConfig",value:function(t){var e=this;return new Promise((function(n){e._config.next(t),e._saveConfig(t),n()}))}},{key:"_initConfig",value:function(){var t=this._storage.getItem(p);t?this._config.next(JSON.parse(t)):this._config.next(d)}},{key:"_saveConfig",value:function(t){this._storage.setItem(p,JSON.stringify(t))}},{key:"config$",get:function(){return this._config}}]),t}(),b=n("b7d7"),h=a["a"].extend({name:"App",data:function(){return{mdiThemeLightDark:c["a"]}},methods:{toggleTheme:function(){var t=s["a"].resolve(u);t.config$.pipe(Object(b["a"])(1)).subscribe((function(e){t.changeConfig(Object(i["a"])(Object(i["a"])({},e),{},{darkTheme:!e.darkTheme}))}))}}}),_=h,g=n("2877"),w=n("6544"),O=n.n(w),j=n("7496"),y=n("8336"),V=n("a523"),C=n("132d"),P=n("f6c4"),x=Object(g["a"])(_,o,r,!1,null,null,null),$=x.exports;O()(x,{VApp:j["a"],VBtn:y["a"],VContainer:V["a"],VIcon:C["a"],VMain:P["a"]});var T=n("8c4f"),k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",[n("v-col",{attrs:{cols:8}},[n("create-post-form",{attrs:{"on-submit":t.onSubmitHandler}}),n("PostViewsList",{attrs:{"post-views":t.postViews}})],1),n("v-col",{attrs:{cols:4}},[n("h3",{staticClass:"mb-4"},[t._v("Самые обсуждаемые посты")]),n("most-discussed-posts-list",{attrs:{list:t.mostDiscussedPostViews}})],1)],1)},I=[],S="IPostFeedService",D=(n("d81d"),n("fb6a"),n("9ab4")),A="IPostsRepository",L=(n("99af"),n("4de4"),n("4160"),n("4ec9"),n("3ca3"),n("159b"),n("ddb0"),n("15fd")),M=n("3835"),E=n("2909"),F=n("dba1"),N=n("7738"),G=(n("ac1f"),n("5319"),n("359c")),R=n("ec26"),J={avatar:G["image"].people(100,100),fullname:"Random Man"},H="TT_POSTS_LIST",q="TT_COMMENTS_LIST",z=function(){return{avatar:G["image"].people(100,100)+"?q=".concat(Object(R["a"])()),fullname:G["name"].firstName()+" "+G["name"].lastName()}},B=function(t){return{postId:t,id:Object(R["a"])(),createDate:(new Date).toISOString(),author:z(),content:Math.random()>.5?G["lorem"].paragraph():G["lorem"].lines()}},K=function(t){var e=/http?s?:?\/\/[^"']*\.(gif|jpe?g|tiff?|png|webp|bmp|svg)/.exec(t.content),n=null===e?null:e[0],s=null===e?t.content:t.content.replace(e[0],"");return{id:Object(R["a"])(),createDate:(new Date).toISOString(),author:J,image:n,content:s}},Q=n("d2636"),U=n("ebb6"),W=n("9254"),X=function(){function t(e){var n=this;Object(l["a"])(this,t),this._storage=e,this._postViews$=void 0,this._scheduledGenerators=new Map,this._posts$=new F["a"](this._getPosts()),this._comments$=new F["a"](this._getComments()),this._posts$.subscribe((function(t){t.forEach((function(t){var e=t.id;return n._initCommentGenerator(e)}))})),this._posts$.pipe(Object(Q["a"])(1)).subscribe((function(t){return n._savePosts(t)})),this._comments$.pipe(Object(Q["a"])(1)).subscribe((function(t){return n._saveComments(t)}))}return Object(m["a"])(t,[{key:"createPost",value:function(t){var e=this;return new Promise((function(n){e._posts$.next([K(t)].concat(Object(E["a"])(e._posts$.getValue()))),n()}))}},{key:"_getPosts",value:function(){var t=this._storage.getItem(H);return t?JSON.parse(t):[]}},{key:"_savePosts",value:function(t){this._storage.setItem(H,JSON.stringify(t))}},{key:"_getComments",value:function(){var t=this._storage.getItem(q);return t?JSON.parse(t):[]}},{key:"_saveComments",value:function(t){this._storage.setItem(q,JSON.stringify(t))}},{key:"_initCommentGenerator",value:function(t){this._scheduledGenerators.has(t)||this._scheduleCommentGenerator(t)}},{key:"_scheduleCommentGenerator",value:function(t){var e=this,n=setTimeout((function(){e._comments$.next([B(t)].concat(Object(E["a"])(e._comments$.getValue()))),e._scheduleCommentGenerator(t)}),G["random"].number({min:5e3,max:3e4,precision:5e3}));this._scheduledGenerators.set(t,n)}},{key:"postViews$",get:function(){return this._postViews$||(this._postViews$=Object(N["a"])(this._posts$,this._comments$).pipe(Object(U["a"])((function(t){var e=Object(M["a"])(t,2),n=e[0],s=e[1];return n.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{comments:s.filter((function(e){var n=e.postId;return n===t.id})).map((function(t){t.postId;var e=Object(L["a"])(t,["postId"]);return e}))})}))})),Object(W["a"])(1))),this._postViews$}}]),t}();X=Object(D["a"])([Object(s["c"])()],X);var Y=function(){function t(e){Object(l["a"])(this,t),this._postRepository=e}return Object(m["a"])(t,[{key:"createPost",value:function(t){return this._postRepository.createPost(t)}},{key:"postViews$",get:function(){return this._postRepository.postViews$.pipe(Object(U["a"])((function(t){return t.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{comments:t.comments.slice(0,3)})}))})))}}]),t}();Y=Object(D["a"])([Object(s["c"])(),Object(D["c"])(0,Object(s["b"])(A))],Y);var Z="IMostDiscussedPostFeedService",tt=(n("a434"),n("498a"),90),et=function(){function t(e){Object(l["a"])(this,t),this._postRepository=e}return Object(m["a"])(t,[{key:"mostDiscussedPostViews$",get:function(){return this._postRepository.postViews$.pipe(Object(U["a"])((function(t){return t.filter((function(t){var e=t.comments;return e.length>0})).sort((function(t,e){return e.comments.length-t.comments.length})).splice(0,3).map((function(t){return{id:t.id,content:t.content.length<tt?t.content:t.content.slice(0,tt).trim()+"...",commentsCount:t.comments.length}}))})))}}]),t}();et=Object(D["a"])([Object(s["c"])(),Object(D["c"])(0,Object(s["b"])(A))],et);var nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-views-list"},[t.postViews.length?t._l(t.postViews,(function(t){return n("post-view",{key:t.id,attrs:{"post-view":t}})})):n("v-alert",{attrs:{outlined:"",type:"info"}},[t._v(" Опубликуйте ваш первый пост ")])],2)},st=[],at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-view"},[n("post-view-card",{attrs:{"post-view":t.postView}}),n("div",{staticClass:"post-view--comment-area"},t._l(t.postView.comments,(function(t){return n("post-view-comment",{key:t.id,attrs:{"comment-view":t}})})),1)],1)},ot=[],rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticClass:"post-view-card",attrs:{outlined:""}},[t.postView.image?n("v-img",{staticClass:"post-view-card--image",attrs:{src:t.postView.image}}):t._e(),n("v-card-text",{staticClass:"post-view-card--post-container"},[n("div",{staticClass:"post-view-card--avatar-container"},[n("AuthorAvatar",{attrs:{author:t.postView.author}})],1),n("div",{staticClass:"post-view-card--content-container"},[n("span",{staticClass:"post-view-card--create-date"},[t._v(" "+t._s(t._f("toLocalDateTime")(t.postView.createDate))+" ")]),t._v(" "+t._s(t.postView.content)+" ")])])],1)},it=[],ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,a=e.attrs;return[n("v-avatar",t._g(t._b({attrs:{size:t.avatarSize}},"v-avatar",a,!1),s),[n("img",{attrs:{src:t.author.avatar,alt:t.author.fullname}})])]}}])},[n("span",[t._v(t._s(t.author.fullname))])])},ut=[],lt=(n("c96a"),a["a"].extend({name:"AuthorAvatar",props:{author:{type:Object,required:!0},small:{type:Boolean,required:!1,default:!1}},computed:{avatarSize:function(){return this.small?46:84}}})),mt=lt,ft=n("8212"),pt=n("3a2f"),dt=Object(g["a"])(mt,ct,ut,!1,null,null,null),vt=dt.exports;O()(dt,{VAvatar:ft["a"],VTooltip:pt["a"]});var bt=a["a"].extend({name:"PostViewCard",props:{postView:Object},components:{AuthorAvatar:vt}}),ht=bt,_t=(n("a82a"),n("b0af")),gt=n("99d9"),wt=n("adda"),Ot=Object(g["a"])(ht,rt,it,!1,null,null,null),jt=Ot.exports;O()(Ot,{VCard:_t["a"],VCardText:gt["a"],VImg:wt["a"]});var yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticClass:"post-view-comment",attrs:{flat:""}},[n("v-card-text",{staticClass:"post-view-comment--post-container"},[n("div",{staticClass:"post-view-comment--avatar-container"},[n("AuthorAvatar",{attrs:{author:t.commentView.author,small:""}})],1),n("div",{staticClass:"post-view-comment--content-container"},[n("span",{staticClass:"post-view-comment--create-date"},[t._v(" "+t._s(t._f("toLocalDateTime")(t.commentView.createDate))+" ")]),t._v(" "+t._s(t.commentView.content)+" ")])])],1)},Vt=[],Ct=a["a"].extend({name:"PostViewComment",props:{commentView:Object},components:{AuthorAvatar:vt}}),Pt=Ct,xt=(n("e469"),Object(g["a"])(Pt,yt,Vt,!1,null,null,null)),$t=xt.exports;O()(xt,{VCard:_t["a"],VCardText:gt["a"]});var Tt=a["a"].extend({name:"PostView",props:{postView:Object},components:{PostViewCard:jt,PostViewComment:$t}}),kt=Tt,It=(n("af1d"),Object(g["a"])(kt,at,ot,!1,null,null,null)),St=It.exports,Dt=a["a"].extend({name:"PostViewsList",props:{postViews:Array},components:{PostView:St}}),At=Dt,Lt=n("0798"),Mt=Object(g["a"])(At,nt,st,!1,null,null,null),Et=Mt.exports;O()(Mt,{VAlert:Lt["a"]});var Ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"most-discussed-posts-list"},[t.list.length?n("v-list",{attrs:{"two-line":""}},t._l(t.list,(function(e){return n("v-list-item",{key:e.id},[n("v-list-item-avatar",{staticClass:"justify-center text--white",attrs:{color:"accent"}},[t._v(" "+t._s(e.commentsCount)+" ")]),n("v-list-item-content",[t._v(" "+t._s(e.content)+" ")])],1)})),1):n("v-alert",{attrs:{outlined:"",type:"info"}},[t._v(" Пока нет обсуждений ")])],1)},Nt=[],Gt=a["a"].extend({name:"MostDiscussedPostsList",props:{list:{type:Array,required:!0}}}),Rt=Gt,Jt=n("8860"),Ht=n("da13"),qt=n("8270"),zt=n("5d23"),Bt=Object(g["a"])(Rt,Ft,Nt,!1,null,null,null),Kt=Bt.exports;O()(Bt,{VAlert:Lt["a"],VList:Jt["a"],VListItem:Ht["a"],VListItemAvatar:qt["a"],VListItemContent:zt["a"]});var Qt=n("2102"),Ut=a["a"].extend({name:"Home",subscriptions:function(){return{postViews:s["a"].resolve(S).postViews$,mostDiscussedPostViews:s["a"].resolve(Z).mostDiscussedPostViews$}},methods:{onSubmitHandler:function(t){return s["a"].resolve(S).createPost(t)}},components:{PostViewsList:Et,MostDiscussedPostsList:Kt,CreatePostForm:Qt["CreatePostForm"]}}),Wt=Ut,Xt=n("62ad"),Yt=n("0fd9"),Zt=Object(g["a"])(Wt,k,I,!1,null,null,null),te=Zt.exports;O()(Zt,{VCol:Xt["a"],VRow:Yt["a"]}),a["a"].use(T["a"]);var ee=[{path:"/",name:"Home",component:te}],ne=new T["a"]({mode:"history",base:"/tasty-twitter/",routes:ee}),se=ne,ae=n("f309"),oe=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a["a"].use(ae["a"]),new ae["a"]({theme:{dark:t}})},re=n("ce19");s["a"].register(A,{useFactory:Object(s["d"])((function(){return new X(window.localStorage)}))}),s["a"].register(u,{useFactory:Object(s["d"])((function(){return new v(window.localStorage)}))}),s["a"].register(S,{useFactory:Object(s["d"])((function(t){return t.resolve(Y)}))}),s["a"].register(Z,{useFactory:Object(s["d"])((function(t){return t.resolve(et)}))});var ie=n("1315"),ce=function(t){return ie["DateTime"].fromISO(t).toLocaleString(ie["DateTime"].DATETIME_MED)};a["a"].filter("toLocalDateTime",ce),a["a"].use(re["a"]),a["a"].config.productionTip=!1;var ue=s["a"].resolve(u);ue.config$.pipe(Object(b["a"])(1)).subscribe((function(t){var e=t.darkTheme,n=new a["a"]({vuetify:oe(e),router:se,render:function(t){return t($)}});ue.config$.pipe(Object(Q["a"])(1)).subscribe((function(t){var e=t.darkTheme;n.$vuetify.theme.dark=e})),n.$mount("#app")}))}});
//# sourceMappingURL=main.cc1e32db.js.map